#!/usr/bin/env python3
"""
–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –∞–±–±—Ä–µ–≤–∏–∞—Ç—É—Ä –í–û–ö–ö–î–¶ –≤ RAG-—Å–∏—Å—Ç–µ–º–µ —Å —É—á–µ—Ç–æ–º —Å–ª–æ–≤–∞—Ä—è —Å–∏–Ω–æ–Ω–∏–º–æ–≤
"""

import os
import sys
from datetime import datetime
from synonym_dictionary import expand_synonyms
from rag_chatbot import RAGChatBot

def test_abbreviations():
    """–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –∞–±–±—Ä–µ–≤–∏–∞—Ç—É—Ä"""
    
    print("üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –∞–±–±—Ä–µ–≤–∏–∞—Ç—É—Ä –í–û–ö–ö–î–¶")
    print("=" * 60)
    
    # –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–ª–æ–≤–∞—Ä—è —Å–∏–Ω–æ–Ω–∏–º–æ–≤
    print("üìö –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–ª–æ–≤–∞—Ä—è —Å–∏–Ω–æ–Ω–∏–º–æ–≤:")
    test_queries = ["–í–û–ö–ö–î–¶", "–≤–æ–∫–∫–¥—Ü?", "—á—Ç–æ —Ç–∞–∫–æ–µ –≤–æ–∫–∫–¥—Ü", "VOKKDC"]
    for query in test_queries:
        expanded = expand_synonyms(query)
        print(f"  '{query}' ‚Üí '{expanded}'")
    print()
    
    # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º RAG-—á–∞—Ç–±–æ—Ç–∞
    try:
        bot = RAGChatBot(use_mock_embeddings=False)
        print("‚úÖ RAG-—á–∞—Ç–±–æ—Ç —É—Å–ø–µ—à–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω")
        print(f"üìö –ë–∞–∑–∞ –∑–Ω–∞–Ω–∏–π: {bot.knowledge_base.get_stats()}")
        print()
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏: {e}")
        return
    
    # –°–ø–∏—Å–æ–∫ —Ç–µ—Å—Ç–æ–≤—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤
    test_questions = [
        "–í–û–ö–ö–î–¶",  # –ö—Ä–∞—Ç–∫–∞—è —Ñ–æ—Ä–º–∞
        "–ß—Ç–æ —Ç–∞–∫–æ–µ –í–û–ö–ö–î–¶?",
        "VOKKDC",
        "VODC center",
        "–í–æ—Ä–æ–Ω–µ–∂—Å–∫–∏–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–π —Ü–µ–Ω—Ç—Ä",
        "–í–æ—Ä–æ–Ω–µ–∂—Å–∫–∏–π –æ–±–ª–∞—Å—Ç–Ω–æ–π –∫–ª–∏–Ω–∏—á–µ—Å–∫–∏–π –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ç–∏–≤–Ω–æ-–¥–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–π —Ü–µ–Ω—Ç—Ä",
        "–í–û–ö–ö–î–¶ –í–æ—Ä–æ–Ω–µ–∂",
        "–ê–¥—Ä–µ—Å –í–û–ö–ö–î–¶",
        "–¢–µ–ª–µ—Ñ–æ–Ω –í–û–ö–ö–î–¶",
        "–ö–∞–∫ –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –≤ –í–û–ö–ö–î–¶?",
        "–†–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã –í–û–ö–ö–î–¶"
    ]
    
    for i, question in enumerate(test_questions, 1):
        print(f"{i}. ‚ùì {question}")
        try:
            response = bot.send_message(question)
            print(f"   ü§ñ –û—Ç–≤–µ—Ç: {response[:200]}...")  # –ü–µ—Ä–≤—ã–µ 200 —Å–∏–º–≤–æ–ª–æ–≤
            print(f"   üìä –£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å: {getattr(response, 'confidence', 'N/A')}")
            print(f"   üìñ –ò—Å—Ç–æ—á–Ω–∏–∫–∏: {getattr(response, 'sources', 'N/A')}")
        except Exception as e:
            print(f"   ‚ùå –û—à–∏–±–∫–∞: {e}")
        print("-" * 60)
        print()

if __name__ == "__main__":
    test_abbreviations()